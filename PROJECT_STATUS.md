# プロジェクト現状報告書 (Project Status Report)

**更新日**: 2026-01-22
**プロジェクト名**: LoL Coach AI

## 1. プロジェクト概要

**LoL Coach AI** は、League of Legendsの試合データ（Riot API）および動画・画像認識（AI Vision）を活用して、プレイヤーに具体的な改善アドバイスを提供するAIコーチングアプリケーションです。プレイヤーのランク帯やロールに合わせたパーソナライズされた指導を行うことを特徴としています。

## 2. 現在のステータス (Current Status)

**フェーズ**: プロトタイプ 〜 アルファ版運用中
**注力領域**: AI分析精度の向上とハルシネーション（嘘の情報の生成）の排除

### 技術スタック

- **Frontend**: Next.js (App Router), React, Tailwind CSS, Shadcn UI
- **Backend**: Next.js Server Actions
- **Database/Auth**: Supabase
- **AI**: Google Gemini Pro / Flash (GenAI)
- **External API**: Riot Games API

## 3. 実装済み機能 (Implemented Features)

### A. Core Features

- **ユーザー認証**: Supabase Authによるログイン/サインアップ、Riot ID連携。
- **ダッシュボード**: ランク情報、直近の戦績表示、統計ウィジェット。
- **多言語対応 (i18n)**: 日本語、英語、韓国語の切り替え対応。

### B. AI Coaching (Macro Analysis)

- **タイムライン分析**: 試合のイベントデータに基づき、マクロ視点（判断、オブジェクト管理）でのアドバイスを生成。
- **ロール別分析**: TOP/JG/MID/BOT/SUP それぞれの役割に特化した分析ロジックを実装済み。
- **総括分析 (Summary Analysis)**:
  - 試合全体の「根本原因 (Root Cause)」を特定。
  - 「優先改善ポイント (Priority Focus)」を提示（例: デス削減、視界管理など）。
  - 具体的なアクションプランの提示。
- **ビルド診断**: 対面や状況に合わせたビルド選択の評価。

### C. Reliability & Accuracy (重要)

- **Truth Events 検証**: AIの出力がRiot APIの確定事実に基づいているか検証するロジックを実装。
- **ハルシネーション対策**: 「推測」の禁止、事実ベースの描写のみを行うようプロンプトを厳格化。
- **プロンプトエンジニアリング**: プロンプト自体を英語化し、正確性を向上（出力はユーザー指定言語）。

## 4. 直近で行った作業 (Recent Changes)

1. **マクロ分析の再定義**: チーム全体の動きではなく、「ユーザー個人の成長」にフォーカスを変更。
2. **AIプロンプトの英語化**: 言語モデルの性能を最大化するため、システムプロンプトを英語に統一（`analyzeMatchTimeline` 等）。
3. **フロントエンド実装**: マクロ分析結果に「総括分析」セクション（原因・アクションプラン）を追加表示。
4. **不具合修正**: localeファイル（json）の構文エラー修正完了。

## 5. 今後の課題・追加が必要な機能 (Future Roadmap)

### A. 短期的な課題 (Short-term)

- **解析ロジックの継続的改善 (最優先)**:
  - 現状の課題: 依然として残るハルシネーションと、ユーザーの期待値との乖離。
  - 対策: プロンプトの継続的な調整、取得データの拡充・見直し（Riot API活用方法の改善）。
- **UI i18nの完遂**: エラーメッセージやツールチップなど、未翻訳部分の対応。
- **Micro分析 (Vision) の強化**: 現在はマクロ分析が主。ミクロ（操作精度、クリック位置など）の分析ロジックの実装と精度向上。
- **エラーハンドリング**: APIレート制限（Riot/Gemini）発生時のユーザー体験向上。

### B. 中長期的な機能追加 (Long-term)

- **完全な動画解析フロー**: ユーザーがアップロードした動画、またはリプレイファイルからの自動動画生成・解析フローの確立。
- **コーチング履歴の可視化**: 過去のアドバイスに基づいた成長推移のグラフ化。
- **モバイル対応の最適化**: 複雑な分析データのスマホでの表示最適化。

## 6. ディレクトリ構造の要点

- `/src/app/actions/coach.ts`: AIコーチングのコアロジック（プロンプト生成、分析実行）。
- `/src/app/actions/promptUtils.ts`: 英語化されたプロンプトテンプレート。
- `/src/locales`: 多言語定義ファイル (ja.json, en.json, ko.json)。
- `/src/app/dashboard/coach`: コーチング機能のUIコンポーネント。
