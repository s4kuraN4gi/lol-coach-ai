# AddGuestUser ブランチ 残作業管理

## 完了済み作業

- [x] ゲストユーザー機能の実装（`/analyze` ページ、クレジット管理、リワード広告）
- [x] 3 ティアのユーザー対応（ゲスト / 無料会員 / プレミアム）
- [x] マクロ分析・ミクロ分析フロー実装
- [x] リワード広告モーダル (`RewardedAdModal.tsx`) 実装
- [x] ゲストクレジットシステム（Cookie ベース）実装
- [x] 無料会員の週間クレジット管理実装
- [x] Pricing ページ作成
- [x] i18n 対応（ja / en / ko）
- [x] Supabase マイグレーション作成 (`20260206000001_guest_credits.sql`)
- [x] ミクロ分析スライダーバグ修正（`videoDuration` を `useState` 化）
- [x] TypeScript コンパイルエラーなし確認済み

## 手動確認が必要な残タスク

### リワード広告の動作確認

- [ ] ゲスト・無料会員で分析実行前にリワード広告モーダルが表示されること
- [ ] 広告視聴完了後に分析フローが開始されること（`handleAdComplete` コールバック）
- [ ] 分析モード切替（マクロ/ミクロ）や再分析時に `adCompleted` ステートがリセットされること
- [ ] 広告を見ずに閉じた場合の `onClose` ハンドラが正しく動作すること

### ミクロ分析の結果表示確認

- [ ] E2E フロー確認: 動画アップロード → クリップ選択 → フレーム抽出 → ジョブ送信 → ポーリング → 結果表示
- [ ] 拡張結果 UI（状況スナップショット、トレード分析、メカニクス評価、改善点）が正しく描画されること
- [ ] `enhanced` データがない場合のレガシーフォールバック UI が動作すること
- [ ] 各セクションの展開/折りたたみが動作すること
- [ ] グレード表示（S/A/B/C/D + 色分け）が正しく描画されること

### videoDuration スライダー修正の確認

- [ ] 動画挿入 → ミクロタブ切替 → スライダーが即座に操作可能であること
- [ ] スライダーの max が「動画の長さ - 30 秒」であること
- [ ] 動画変更時にスライダーが 0 にリセットされること

## その他の未確認項目

- [ ] 全変更がまだ未コミット（コミット・PR 作成が必要）
- [ ] Supabase マイグレーション (`guest_credits`) を本番/ステージング環境に適用
- [ ] ゲストクレジットの E2E テスト（消費、再生成タイミング、上限、クレジット枯渇時のアップグレード促進）
- [ ] 無料会員のマッチ検証フロー（AI が動画と選択試合の一致を確認）の手動テスト
- [ ] Pricing ページの内容・表示確認
